# 学习报告：四元数与离散傅里叶变换

@TODO:
分工

组员:

- 202518014628074 蒋康
- 2025E8017483006 何鹏程
- 202528013229093 廖思清
- 202518020629020 郑钦元
- 202528013229038 崔晨宇
- 202528013229031 秦超洋

## 一、四元数（Quaternions）

### 1.1 基本定义与表示
四元数是复数在四维空间中的推广，由**一个实部**和**三个虚部**构成：
\[
q = a + b\mathbf{i} + c\mathbf{j} + d\mathbf{k} \quad (a,b,c,d \in \mathbb{R})
\]
其中：
- \(a\) 为实部（scalar part）
- \(b\mathbf{i} + c\mathbf{j} + d\mathbf{k}\) 为虚部（vector part）
- \(\mathbf{i},\mathbf{j},\mathbf{k}\) 为四元数单位元，满足以下乘法规则：
  \[
  \begin{aligned}
  \mathbf{i}^2 &= \mathbf{j}^2 = \mathbf{k}^2 = -1 \\
  \mathbf{ij} &= \mathbf{k}, \quad \mathbf{jk} = \mathbf{i}, \quad \mathbf{ki} = \mathbf{j} \\
  \mathbf{ji} &= -\mathbf{k}, \quad \mathbf{kj} = -\mathbf{i}, \quad \mathbf{ik} = -\mathbf{j} \\
  \mathbf{ijk} &= -1
  \end{aligned}
  \]

### 1.2 核心运算

#### 1.2.1 四元数乘法
给定两个四元数 \(q_1 = a_1 + b_1\mathbf{i} + c_1\mathbf{j} + d_1\mathbf{k}\)，\(q_2 = a_2 + b_2\mathbf{i} + c_2\mathbf{j} + d_2\mathbf{k}\)：
\[
q_1 q_2 = (a_1a_2 - b_1b_2 - c_1c_2 - d_1d_2) 
        + (a_1b_2 + b_1a_2 + c_1d_2 - d_1c_2)\mathbf{i}
        + (a_1c_2 - b_1d_2 + c_1a_2 + d_1b_2)\mathbf{j}
        + (a_1d_2 + b_1c_2 - c_1b_2 + d_1a_2)\mathbf{k}
\]
这个公式可通过乘法分配律和单位元规则推导得出。

#### 1.2.2 共轭与模长
- **共轭四元数**：\(q^* = a - b\mathbf{i} - c\mathbf{j} - d\mathbf{k}\)
- **模长**：\(\|q\| = \sqrt{qq^*} = \sqrt{a^2 + b^2 + c^2 + d^2}\)
- **单位四元数**：\(\|q\| = 1\)，用于表示旋转

### 1.3 几何意义：三维旋转表示

#### 1.3.1 旋转公式
对于一个三维向量 \(\mathbf{v} = (x,y,z)\)，可视为纯四元数 \(v = 0 + x\mathbf{i} + y\mathbf{j} + z\mathbf{k}\)。
绕单位轴 \(\mathbf{u} = (u_x, u_y, u_z)\) 旋转角度 \(\theta\) 的操作为：
\[
v' = q v q^*
\]
其中 \(q = \cos\frac{\theta}{2} + (u_x\mathbf{i} + u_y\mathbf{j} + u_z\mathbf{k})\sin\frac{\theta}{2}\) 为单位四元数。

#### 1.3.2 理解思考：为何用半角？
这是四元数表示中最巧妙也最令人困惑的地方。推导过程显示：
1. 旋转操作需要两次乘法（\(qvq^*\)）
2. 每个乘法都引入一半的旋转效果
3. 因此旋转角度需要减半来补偿
实际验证：设 \(v\) 为与旋转轴垂直的向量，计算 \(v'\) 会得到旋转 \(\theta\) 后的结果。

### 1.4 优势与应用

#### 1.4.1 相比于欧拉角
- **无万向节死锁**：四元数用四个参数表示三维旋转，不会出现奇异点
- **插值自然**：球面线性插值（SLERP）在四元数单位球面上沿大圆路径移动，旋转平滑
- **计算高效**：旋转组合只需四元数乘法，比矩阵乘法计算量小

#### 1.4.2 相比于旋转矩阵
- **存储更省**：四元数（4个浮点数） vs 旋转矩阵（9个浮点数）
- **数值稳定**：容易保持单位长度，矩阵可能因累积误差失去正交性

#### 1.4.3 主要应用领域
- 计算机图形学：相机控制、角色动画
- 机器人学：姿态估计、路径规划
- 航空航天：飞行器姿态控制
- VR/AR：头部追踪与方向计算

---

## 二、离散傅里叶变换（Discrete Fourier Transform, DFT）

### 2.1 基本定义与公式
对于长度为 \(N\) 的离散序列 \(x[n] \ (n=0,1,...,N-1)\)，其DFT定义为：
\[
X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-j\frac{2\pi}{N}kn}, \quad k=0,1,...,N-1
\]
逆变换（IDFT）为：
\[
x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] \cdot e^{j\frac{2\pi}{N}kn}, \quad n=0,1,...,N-1
\]

### 2.2 傅里叶矩阵：理解DFT的线性代数视角

#### 2.2.1 定义傅里叶矩阵
令 \(W_N = e^{-j\frac{2\pi}{N}}\)（旋转因子，第 \(N\) 次单位根），则 \(N \times N\) 的傅里叶矩阵 \(F_N\) 定义为：
\[
F_N = 
\begin{bmatrix}
W_N^{0\cdot0} & W_N^{0\cdot1} & \cdots & W_N^{0\cdot(N-1)} \\
W_N^{1\cdot0} & W_N^{1\cdot1} & \cdots & W_N^{1\cdot(N-1)} \\
\vdots & \vdots & \ddots & \vdots \\
W_N^{(N-1)\cdot0} & W_N^{(N-1)\cdot1} & \cdots & W_N^{(N-1)\cdot(N-1)}
\end{bmatrix}
\]
即 \((F_N)_{k,n} = W_N^{kn} = e^{-j\frac{2\pi}{N}kn}\)。

#### 2.2.2 DFT的矩阵表示
将信号向量化：\(\mathbf{x} = [x[0], x[1], ..., x[N-1]]^T\)
将频谱向量化：\(\mathbf{X} = [X[0], X[1], ..., X[N-1]]^T\)

则DFT可表示为：
\[
\mathbf{X} = F_N \mathbf{x}
\]
IDFT可表示为：
\[
\mathbf{x} = \frac{1}{N} F_N^* \mathbf{X}
\]
其中 \(F_N^*\) 是 \(F_N\) 的共轭转置。

#### 2.2.3 傅里叶矩阵的性质
1. **对称性**：\(F_N\) 是对称矩阵（但非Hermitian）
2. **正交性**：\(\frac{1}{\sqrt{N}}F_N\) 是酉矩阵，即：
   \[
   F_N F_N^* = F_N^* F_N = N I_N
   \]
   其中 \(I_N\) 是 \(N\times N\) 单位矩阵。
3. **可逆性**：\(F_N^{-1} = \frac{1}{N}F_N^*\)
4. **循环结构**：矩阵的每一行（或列）都是上一行（或列）的循环移位，乘上 \(W_N\) 的幂次。

### 2.3 DFT的深入理解

#### 2.3.1 频率分量的物理意义
- \(X[0]\)：直流分量，序列的平均值
- \(X[1]\)：基频分量，周期为 \(N\)
- \(X[k]\)：第 \(k\) 次谐波，频率为基频的 \(k\) 倍
- \(X[N-k]\)：与 \(X[k]\) 共轭，表示负频率成分（由于对称性）

#### 2.3.2 周期性假设
DFT隐含假设信号以 \(N\) 为周期延拓。这意味着：
- 频域离散化对应时域周期化
- 时域离散化对应频域周期化（周期为采样率 \(f_s\)）
- 实际应用中需注意**频谱泄漏**和**栅栏效应**

### 2.4 快速傅里叶变换（FFT）原理

#### 2.4.1 分治思想
FFT基于Cooley-Tukey算法，核心是将DFT分解为更小的DFT：
\[
X[k] = \sum_{n=0}^{N-1} x[n] W_N^{kn}
     = \sum_{m=0}^{N/2-1} x[2m] W_N^{k(2m)}
     + \sum_{m=0}^{N/2-1} x[2m+1] W_N^{k(2m+1)}
\]
令 \(W_N^2 = W_{N/2}\)，则：
\[
X[k] = \sum_{m=0}^{N/2-1} x[2m] W_{N/2}^{km}
     + W_N^k \sum_{m=0}^{N/2-1} x[2m+1] W_{N/2}^{km}
\]

#### 2.4.2 矩阵分解视角
FFT相当于对傅里叶矩阵进行因式分解：
\[
F_N = P_N \begin{bmatrix}
F_{N/2} & D_{N/2} F_{N/2} \\
F_{N/2} & -D_{N/2} F_{N/2}
\end{bmatrix}
\]
其中：
- \(P_N\)：置换矩阵（重排偶数和奇数索引）
- \(D_{N/2}\)：对角矩阵，元素为 \(W_N^0, W_N^1, ..., W_N^{N/2-1}\)

#### 2.4.3 算法复杂度
- 直接DFT：\(O(N^2)\) 次复数乘法
- FFT：\(O(N\log_2 N)\) 次复数乘法
- 当 \(N=1024\) 时，加速比约为 \(1024/\log_2 1024 \approx 100\)

### 2.5 DFT的应用领域

#### 2.5.1 信号处理
- **频谱分析**：语音识别、振动分析
- **滤波**：频域乘法等效于时域卷积
- **相关分析**：计算信号相似度

#### 2.5.2 图像处理
- **二维DFT**：图像频域分析
- **图像压缩**：JPEG使用DCT（DFT的实部变换）
- **图像滤波**：高通/低通/带通滤波

#### 2.5.3 通信系统
- **OFDM**：正交频分复用，利用DFT/IDFT实现多载波调制
- **信道估计**：通过导频信号估计频率响应

---

## 三、概念对比与综合思考

### 3.1 数学结构的相似性

| 特性 | 四元数 | DFT（傅里叶矩阵） |
|------|--------|------------------|
| 维度扩展 | 复数→四元数（四维） | 实数/复数→频域表示 |
| 乘法规则 | 非交换代数 | 矩阵乘法（可交换，因傅里叶矩阵可对角化） |
| 正交性 | 单位四元数构成三维球面 | 傅里叶矩阵列向量正交 |
| 变换操作 | 共轭乘法表示旋转 | 矩阵乘法表示时频变换 |

### 3.2 理解难点的共性分析

#### 3.2.1 抽象维度
- 四元数：用四维代数对象表示三维旋转，需建立几何直观
- DFT：时域到频域的变换，需理解复数频率的物理意义

#### 3.2.2 符号与记法
- 四元数：三个虚单位 \(i,j,k\) 及其非交换乘法
- DFT：旋转因子 \(W_N = e^{-j2\pi/N}\) 的幂次运算

#### 3.2.3 隐含假设
- 四元数旋转：默认向量表示为纯四元数
- DFT：默认信号周期延拓，采样定理前提

### 3.3 工程应用的互补性

在实际系统中，两者可能协同工作：
1. **运动捕捉系统**：传感器数据（加速度、角速度）通过DFT分析频率特征，姿态通过四元数融合
2. **机器人控制**：路径规划中的轨迹用DFT分析，末端执行器姿态用四元数插值
3. **计算机视觉**：图像处理用DFT/FFT，三维重建中的旋转用四元数表示

### 3.4 学习心得与启示

#### 3.4.1 四元数学习要点
1. 从复数旋转（二维）类比到四元数旋转（三维）
2. 用具体例子验证旋转公式，建立几何直观
3. 理解SLERP插值的几何意义：四维单位球面上的大圆弧

#### 3.4.2 DFT学习要点
1. 从傅里叶级数→连续FT→离散FT的演变过程
2. 通过傅里叶矩阵理解DFT的线性代数本质
3. 手动推导小N值（如N=4）的FFT蝶形图，理解分治策略

#### 3.4.3 计算实现建议
- 四元数：实现四元数类，重载乘法运算符，验证旋转性质
- DFT/FFT：先实现直接DFT（理解原理），再实现递归FFT，最后迭代优化

---

## 四、总结

四元数和离散傅里叶变换虽然属于不同数学分支，但都体现了**用巧妙数学工具解决实际问题**的思想：

1. **四元数**通过扩展复数系统，以紧凑、稳定的方式处理三维旋转问题，避免了欧拉角的万向节死锁和旋转矩阵的冗余。

2. **DFT**通过傅里叶矩阵将信号分解为频率分量，FFT算法极大提升了计算效率，成为现代数字信号处理的基石。

理解这两个概念的关键在于：
- 把握从简单到复杂的推广过程（复数→四元数，连续FT→离散FT）
- 建立几何/物理直观，而不仅停留在公式层面
- 通过编程实现加深理解，观察参数变化的影响

这两项技术将继续在计算机图形学、机器人、通信等领域发挥核心作用，是现代工程师和研究人员的重要数学工具。

---

**参考文献**：
1. Kuipers, J. B. (1999). *Quaternions and Rotation Sequences*
2. Oppenheim, A. V., & Schafer, R. W. (2010). *Discrete-Time Signal Processing*
3. Cooley, J. W., & Tukey, J. W. (1965). *An algorithm for the machine calculation of complex Fourier series*
